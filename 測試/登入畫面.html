<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <center><font size=6 color=navy >
        <h1>abc先生你好！</h1></font>
        </center>
        <font size=6 color=blue id='clock'></font>
        <script language="javascript">
            var  ID_Interval = 0 ;
            var  SS_Interval = false ;
            var  O_ajax = false ;
            var  A_gpio = new Array() ;
            my_init();   
          function my_init() {
            if ( window.ActiveXObject ) O_ajax = new ActiveXObject("Microsoft.XMLHTTP")
            else  O_ajax = new XMLHttpRequest()
            var i;
            for ( i=0; i < 82-61 ; i++ ) A_gpio[i]= '0' ;
          }  
          
          function chg(nn) { 
            if ( SS_Interval ) {
              clearInterval( ID_Interval ) ;
              SS_Interval = false ;
            } 
            url = "state_gpio.php?ID=chg&led="+nn ;
            O_ajax.open("get",url,true);
            O_ajax.onreadystatechange = flash_chk ;
            O_ajax.send(null);
          }
          
          function flash_chk() {
            if ( O_ajax.readyState == 4 && O_ajax.status == 200 ) {
              var msg = O_ajax.responseText;
              var a_state = msg.split("");
              var i , j , c
              for ( i=0; i < 21 ; i++ ) {
                if ( A_gpio[i] != a_state[i] ) {
                  A_gpio[i] = a_state[i]
              j=i+61
           //       c=(i>7)?'yellow':'red';
                  document.getElementById(""+j).style.backgroundColor=(a_state[i]=='1')?((i>7)?'yellow':'red'):'gold'	
                }
              }
            }
            if ( ! SS_Interval ) {
              ID_Interval = setInterval("routine()",1000);
              SS_Interval = true ;
            }
          }
          
          function routine() {
            var dd=new Date();
            var tt=dd.toLocaleTimeString();  
            url = "state_gpio.php?ID=rr&led=00" ;
            O_ajax.open("get",url,true);
            O_ajax.onreadystatechange = flash_chk ;
            O_ajax.send(null);
            document.getElementById('clock').innerHTML = tt ;
          }
          </script>
          <script>
            ID_Interval = setInterval("routine()",200);
            SS_Interval = true ;
          </script>
</body>
</html>